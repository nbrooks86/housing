DROP VIEW "CORE_LEVEL1"."HOUSING_ENTRY_APPLICATION" ;
CREATE VIEW "CORE_LEVEL1"."HOUSING_ENTRY_APPLICATION" AS
SELECT
	CAST(ENTRYAPPLICATIONID AS NVARCHAR(8)) AS "ENTRY_APPLICATION_ID",
	CAST(ENTRYID AS NVARCHAR(8)) AS "ENTRY_ID" ,
	APPLICATIONSTATUSID as "ENTRY_APPLICATION_STATUS_CODE" ,
	CLASSIFICATIONID AS "CLASSIFICATION_ID" ,
	"TERMID" AS "TERM_ID",
	CASE 
		WHEN RETURNING = '1'
		THEN 'Y'
		ELSE 'N'
	END AS "IS_RETURNING",
	TO_DATE("EXPECTEDARRIVALDATE") AS "EXPECTED_ARRIVAL_DATE",
	TO_DATE("EXPECTEDARRIVALDATELATEST") AS "EXPECTED_ARRIVAL_DATE_LATEST",
	TO_DATE("EXPECTEDDEPARTUREDATE") AS "EXPECTEDDEPARTUREDATE",
	TO_DATE("APPLICATIONDATE") AS "APPLICATION_DATE",
	--"RATING" , NULL
	TO_DATE("CANCELDATE") AS "CANCEL_DATE",
	TO_DATE("ENQUIRYDATE") AS "INQUIRY_DATE",
	TO_DATE("RECEIVEDDATE") AS "RECEIVED_DATE",
	CASE 
		WHEN "RECEIVEDFEE" = '1'
		THEN 'Y'
		ELSE 'N'
	END AS "HAS_RECEIVED_FEE",
	CAST(RECEIVEDFEE_PAYMENTID AS NVARCHAR(8)) AS "RECEIVED_FREE_PAYMENT_ID",
	TO_DATE("RECEIVEDFEEDATE") AS "RECEIVED_FEE_DATE",
	"RECEIVEDFEEAMOUNT" AS "RECEIVED_FEE_AMOUNT",
	CASE 
		WHEN "RECEIVEDDEPOSIT" = '1'
		THEN 'Y'
		ELSE 'N'
	END AS "HAS_RECEIVED_DEPOSIT",
	--"RECEIVEDDEPOSITWAIVED" , ALL 0'S
	CAST(RECEIVEDDEPOSIT_PAYMENTID AS NVARCHAR(8)) AS "RECEIVED_DEPOSIT_PAYMENT_ID" ,
	TO_DATE("RECEIVEDDEPOSITDATE") AS "RECEIVED_DEPOSIT_DATE",
	"RECEIVEDDEPOSITAMOUNT" AS "RECEIVED_DEPOSIT_AMOUNT",
	TO_DATE("RECEIVEDPHOTODATE") AS "RECEIVED_PHOTO_DATE",
	TO_DATE("OFFEREDDATE") AS "OFFERED_DATE",
	TO_DATE("OFFERSENTDATE") AS "OFFER_SENT_DATE",
	--"OFFERREPLYENUM" ,
	TO_DATE("OFFERREPLYDATE") AS "OFFER_REPLY_DATE",
	--"OFFERREPLYREASON" ,
	TO_DATE("CONTRACTSIGNEDDATE") AS "CONTRACT_SIGNED_DATE",
	--"PREFERENCECOMMENTS" ,
	"ROOMPREFERENCECOMMENTS" AS "ROOM_PREFERENCE_COMMENTS",
	--"COMMENTS" ,
	"COMMENTSINTERNAL" AS "INTERNAL_COMMENTS",
	"WEB" ,
	TO_TIMESTAMP("ROOMSELECTIONTIMESLOT") AS "ROOM_SELECTION_TIME_SLOT",
	--"ROOMSELECTIONNUMBER" ,
	--"ROOMMATEGROUPID" ,
	"ROOMMATESHOWINSEARCH" AS "ROOMMATE_SHOW_IN_SEARCH",
	"ROOMMATEDESCRIPTION" AS "ROOMMATE_DESCRIPTION",
	"CUSTOMBIT1" AS "CUSTOM_BIT1",
	"CUSTOMBIT2" AS "CUSTOM_BIT2",
	"CUSTOMBIT3" AS "CUSTOM_BIT3",
	"CUSTOMBIT4" AS "CUSTOM_BIT4",
	TO_DATE("CUSTOMDATE1") AS "CUSTOM_DATE1",
	TO_DATE("CUSTOMDATE2") AS "CUSTOM_DATE2",
	--TO_DATE("CUSTOMDATE3") AS "CUSTOMDATE3",
	TO_DATE("CUSTOMDATE4") AS "CUSTOM_DATE4",
	"SECURITYUSERID" AS "SECURITY_USER_ID",
	TO_DATE("DATEMODIFIED") AS "DATE_MODIFIED",
	TO_DATE("DATECREATED") AS "DATE_CREATED",
	TO_DATE("COMPLETEDATE") AS "COMPLETE_DATE",
	--"RECEIVEDFEE_WEBPAYMENTID" AS "RECEIVED_FEE_WEB_PAYMENT_ID",
	--"RECEIVEDDEPOSIT_WEBPAYMENTID" ,
	--"ROOMMATEGROUPSORTORDER" ,
	"ALLOCATEOPTIONENUM" AS "ALLOCATE_OPTION",
	"PORTALTRACKINGONLY" AS "PORTAL_TRACKING_ONLY",
	CAST(TABLEID AS NVARCHAR(8)) AS "TABLE_ID",
	"TABLENAME" AS "TABLE_NAME"
FROM "STARREZ"."ENTRYAPPLICATION"